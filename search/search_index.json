{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Galaxy Spring Day 2019 - Reference-based RNAseq analysis March 21st 2019 In this training session, we are going to perform an RNAseq analysis as first outlined in Galaxy training material for Reference-based RNAseq analysis We have updated the instructions given in this training material and put these instructions in this readthedoc site for the spring day 2019. We will propose the update for a pull request to the galaxyproject training-material repository In this tutorial, we will deal with: Pretreatments Data upload Quality control Mapping Mapping Inspection of the mapping results Analysis of the differential gene expression Count the number of reads per annotated gene Viewing datasets side by side using the Scratchbook Identification of the differentially expressed features Visualization of the differentially expressed genes Analysis of functional enrichment among the differentially expressed genes","title":"Home"},{"location":"#galaxy-spring-day-2019-reference-based-rnaseq-analysis","text":"","title":"Galaxy Spring Day 2019 - Reference-based RNAseq analysis"},{"location":"#march-21st-2019","text":"In this training session, we are going to perform an RNAseq analysis as first outlined in Galaxy training material for Reference-based RNAseq analysis We have updated the instructions given in this training material and put these instructions in this readthedoc site for the spring day 2019. We will propose the update for a pull request to the galaxyproject training-material repository In this tutorial, we will deal with: Pretreatments Data upload Quality control Mapping Mapping Inspection of the mapping results Analysis of the differential gene expression Count the number of reads per annotated gene Viewing datasets side by side using the Scratchbook Identification of the differentially expressed features Visualization of the differentially expressed genes Analysis of functional enrichment among the differentially expressed genes","title":"March 21st 2019"},{"location":"Cutadapt/","text":"Filtering datasets to remove or trim low quality sequences This step is optional and should be performed by 50% of attendees. Cutadapt with single reads Create a new history Cutapdapt Copy the fastq files from the RNAseq data library to this new history Select the Cutadapt tool Start with selecting Single-end in the Single-end or Paired-end reads? menu Select the multiple datasets button for this menu Cmd-Click for discontinuous multiple selection of single fastq.gz files (3 datasets) Filter Options Minimum length : 20 Read Modification Options Quality cutoff : 20 Output Options Report : Yes Do not change the other available parameters and click Execute Cutadapt with paired-end reads Repeat the same procedure as above, except that you select Paired-end in step 4: Re-Run the tool using the re-run button on one Cutadapt instance and just select Paired-end instead of Single-end Then you have two input boxes, one for file #1 and one for file #2. In the box file #1 click the multiple datasets button and carefully Select the fastq.gz files with the _1 suffix In the box file #2 click the multiple datasets button and carefully Select the fastq.gz files with the _2 suffix Do not change the other parameters (they are set to the same value as previously because you used the re-run button). Click the Execute button Run MultiQC on Cutadapt jobs Select MultiQC tool Select Cutadapt/Trim Galore! in the menu Which tool was used generate logs? Cmd-Select the Report datasets generated by Cutadapt Press Execute Now, the borring but essential job: Rename carefully the Output datasets generated by Cutadapt. To do so, help yourself with the Info button at the bottom of dataset green boxes. Example: Rename Cutadapt on data 10 and data 9: Read 2 Output in GSM461181_2_treat_paired.fastq.gz Trash the 11 unfiltered/trimmed fastq.gz files. This is important to avoid mixing filtered and non filtered datasets in the next steps.","title":"Optional filtering of reads on sequence quality"},{"location":"Cutadapt/#filtering-datasets-to-remove-or-trim-low-quality-sequences","text":"","title":"Filtering datasets to remove or trim low quality sequences"},{"location":"Cutadapt/#this-step-is-optional-and-should-be-performed-by-50-of-attendees","text":"","title":"This step is optional and should be performed by 50% of attendees."},{"location":"Cutadapt/#cutadapt-with-single-reads","text":"Create a new history Cutapdapt Copy the fastq files from the RNAseq data library to this new history Select the Cutadapt tool Start with selecting Single-end in the Single-end or Paired-end reads? menu Select the multiple datasets button for this menu Cmd-Click for discontinuous multiple selection of single fastq.gz files (3 datasets) Filter Options Minimum length : 20 Read Modification Options Quality cutoff : 20 Output Options Report : Yes Do not change the other available parameters and click Execute","title":"Cutadapt with single reads"},{"location":"Cutadapt/#cutadapt-with-paired-end-reads","text":"Repeat the same procedure as above, except that you select Paired-end in step 4: Re-Run the tool using the re-run button on one Cutadapt instance and just select Paired-end instead of Single-end Then you have two input boxes, one for file #1 and one for file #2. In the box file #1 click the multiple datasets button and carefully Select the fastq.gz files with the _1 suffix In the box file #2 click the multiple datasets button and carefully Select the fastq.gz files with the _2 suffix Do not change the other parameters (they are set to the same value as previously because you used the re-run button). Click the Execute button","title":"Cutadapt with paired-end reads"},{"location":"Cutadapt/#run-multiqc-on-cutadapt-jobs","text":"Select MultiQC tool Select Cutadapt/Trim Galore! in the menu Which tool was used generate logs? Cmd-Select the Report datasets generated by Cutadapt Press Execute Now, the borring but essential job: Rename carefully the Output datasets generated by Cutadapt. To do so, help yourself with the Info button at the bottom of dataset green boxes. Example: Rename Cutadapt on data 10 and data 9: Read 2 Output in GSM461181_2_treat_paired.fastq.gz Trash the 11 unfiltered/trimmed fastq.gz files. This is important to avoid mixing filtered and non filtered datasets in the next steps.","title":"Run MultiQC on Cutadapt jobs"},{"location":"DE/","text":"","title":"Identification of the differentially expressed features"},{"location":"DEvisu/","text":"","title":"Visualization of the differentially expressed genes"},{"location":"GO/","text":"","title":"Analysis of functional enrichment among the differentially expressed genes"},{"location":"QC/","text":"Quality Control FastQC tool to analyse the fastq (or fastq.gz) datasets create a new history and name it Quality Control Copy again all fastq.gz files from the data library into this history. You should have 11 datasets in your history Select the fastqc tool. In the Short read data from your current history menu, select the multiple datasets button. Shift-Click to select all 11 datasets Click Execute Look at the results of FastQC : These are the datasets named FastQC on data xx: Webpage MultiQC to aggregate and have a general view of sequence qualities in the project Select the MultiQC tool (you can use the search bar). Which tool was used generate logs? : Select FastQC Type of FastQC output? : Select Raw data FastQC output Cmd-Click (discontinuous, multiple selection) the 11 files named FastQC on xx: RawData Click Execute Look at the result of MultiQC , dataset named MultiQC on ...: Webpage Pay attention to the General Statistics that indicate the read sizes. Pay attention to the Sequence Quality Histograms . What can you say about the quality of the samples ? Have a look to the Adapter Content section.","title":"Quality control"},{"location":"QC/#quality-control","text":"","title":"Quality Control"},{"location":"QC/#fastqc-tool-to-analyse-the-fastq-or-fastqgz-datasets","text":"create a new history and name it Quality Control Copy again all fastq.gz files from the data library into this history. You should have 11 datasets in your history Select the fastqc tool. In the Short read data from your current history menu, select the multiple datasets button. Shift-Click to select all 11 datasets Click Execute Look at the results of FastQC : These are the datasets named FastQC on data xx: Webpage","title":"FastQC tool to analyse the fastq (or fastq.gz) datasets"},{"location":"QC/#multiqc-to-aggregate-and-have-a-general-view-of-sequence-qualities-in-the-project","text":"Select the MultiQC tool (you can use the search bar). Which tool was used generate logs? : Select FastQC Type of FastQC output? : Select Raw data FastQC output Cmd-Click (discontinuous, multiple selection) the 11 files named FastQC on xx: RawData Click Execute Look at the result of MultiQC , dataset named MultiQC on ...: Webpage Pay attention to the General Statistics that indicate the read sizes. Pay attention to the Sequence Quality Histograms . What can you say about the quality of the samples ? Have a look to the Adapter Content section.","title":"MultiQC to aggregate and have a general view of sequence qualities in the project"},{"location":"RNAseq_DE/","text":"Statistical Analysis of Differential expression","title":"Statistical Analysis of Differential expression"},{"location":"RNAseq_DE/#statistical-analysis-of-differential-expression","text":"","title":"Statistical Analysis of Differential expression"},{"location":"bam/","text":"Inspection of BAM files Click on the small eye icon of a Bam dataset (generated either with RNA STAR or HISAT2 ) The header contains the chromosome specifications (their name and length) and other informations such as the software that generation the Bam file and the command line to run the software.","title":"BAM inspection"},{"location":"bam/#inspection-of-bam-files","text":"Click on the small eye icon of a Bam dataset (generated either with RNA STAR or HISAT2 ) The header contains the chromosome specifications (their name and length) and other informations such as the software that generation the Bam file and the command line to run the software.","title":"Inspection of BAM files"},{"location":"cDNAs/","text":"cDNA synthesis Oligo-dT Random priming","title":"RNAseq librairies - cDNA synthesis"},{"location":"cDNAs/#cdna-synthesis","text":"","title":"cDNA synthesis"},{"location":"cDNAs/#oligo-dt","text":"","title":"Oligo-dT"},{"location":"cDNAs/#random-priming","text":"","title":"Random priming"},{"location":"count/","text":"","title":"Count the number of reads per annotated gene"},{"location":"hisat2/","text":"HISAT2 (option for 50 % of attendees) create a new history and name it HISAT2 Import the 11 datasets from the RNAseq data library to this RNA STAR history, plus the Drosophila_melanogaster.BDGP6.95.gtf file Select the HISAT2 tool with the following parameters to map your reads on the reference genome: Source for the reference genome : Use a builtin genome Select a reference genome : dm6 Is this a single or paired library: Single-End `FASTA/Q file: GSM461176_untreat_single.fastq.gz GSM461179_treat_single.fastq.gz GSM461182_untreat_single.fastq.gz Specify strand information: Unstranded Summary options Output alignment summary in a more machine-friendly style. : YES Print alignment summary to a file. : YES Leave other settings as defaults Execute Redo the HISAT2 run for paired-end files Rerun the HISAT2 tool with the following parameters to map your reads on the reference genome: Source for the reference genome : Use a builtin genome Select a reference genome : dm6 Is this a single or paired library: Paired-End `FASTA/Q file #1: GSM461177_1_untreat_paired.fastq.gz GSM461178_1_untreat_paired.fastq.gz GSM461180_1_treat_paired.fastq.gz GSM461181_1_treat_paired.fastq.gz `FASTA/Q file #2: GSM461177_2_untreat_paired.fastq.gz GSM461178_2_untreat_paired.fastq.gz GSM461180_2_treat_paired.fastq.gz GSM461181_2_treat_paired.fastq.gz Specify strand information: Unstranded Leave other settings as defaults (since you are redoing a run) Execute Rename your datasets ! You need now to rename you datasets to facilitate your downstream analysis. Be quiet and focus ! No hurry, this is an important task in the analysis. Search and select datasets with HISAT2 Click on the info icon of both (BAM) and Mapping summary files Copy the name or one of the two names of the datasets as shown bellow Now click on the pencil icon of the same dataset Paste your text in the Name field of the dataset Edit your text as follow for Mapping summary files Edit your text as follow for (BAM) files repeat ad lib for all Mapping summary and (BAM) files","title":"HiSAT2"},{"location":"hisat2/#hisat2-option-for-50-of-attendees","text":"create a new history and name it HISAT2 Import the 11 datasets from the RNAseq data library to this RNA STAR history, plus the Drosophila_melanogaster.BDGP6.95.gtf file Select the HISAT2 tool with the following parameters to map your reads on the reference genome: Source for the reference genome : Use a builtin genome Select a reference genome : dm6 Is this a single or paired library: Single-End `FASTA/Q file: GSM461176_untreat_single.fastq.gz GSM461179_treat_single.fastq.gz GSM461182_untreat_single.fastq.gz Specify strand information: Unstranded Summary options Output alignment summary in a more machine-friendly style. : YES Print alignment summary to a file. : YES Leave other settings as defaults Execute Redo the HISAT2 run for paired-end files Rerun the HISAT2 tool with the following parameters to map your reads on the reference genome: Source for the reference genome : Use a builtin genome Select a reference genome : dm6 Is this a single or paired library: Paired-End `FASTA/Q file #1: GSM461177_1_untreat_paired.fastq.gz GSM461178_1_untreat_paired.fastq.gz GSM461180_1_treat_paired.fastq.gz GSM461181_1_treat_paired.fastq.gz `FASTA/Q file #2: GSM461177_2_untreat_paired.fastq.gz GSM461178_2_untreat_paired.fastq.gz GSM461180_2_treat_paired.fastq.gz GSM461181_2_treat_paired.fastq.gz Specify strand information: Unstranded Leave other settings as defaults (since you are redoing a run) Execute","title":"HISAT2  (option for 50 % of attendees)"},{"location":"hisat2/#rename-your-datasets","text":"You need now to rename you datasets to facilitate your downstream analysis. Be quiet and focus ! No hurry, this is an important task in the analysis. Search and select datasets with HISAT2 Click on the info icon of both (BAM) and Mapping summary files Copy the name or one of the two names of the datasets as shown bellow Now click on the pencil icon of the same dataset Paste your text in the Name field of the dataset Edit your text as follow for Mapping summary files Edit your text as follow for (BAM) files repeat ad lib for all Mapping summary and (BAM) files","title":"Rename your datasets !"},{"location":"mapping/","text":"Mapping the reads to the reference genome","title":"Mapping"},{"location":"mapping/#mapping-the-reads-to-the-reference-genome","text":"","title":"Mapping the reads to the reference genome"},{"location":"outline_conclusion/","text":"Experimental procedures affect downstream analyses","title":"Experimental procedures affect downstream analyses"},{"location":"outline_conclusion/#experimental-procedures-affect-downstream-analyses","text":"","title":"Experimental procedures affect downstream analyses"},{"location":"read_filtering/","text":"Focus on quality control \u201cfiltering\u201d in RNAseq analysis It is tempting to filter the data to get \u201cgood counts\u201d low quality alignments PCR duplicates But.. Why low quality reads should be skipped if they were aligned ? Is the implicit hypothesis \"low quality read are miss-mapped\" a likely hypothesis ? When we remove PCR duplicates (exact same sequence and exact same location), are we sure that we remove PCR duplicates ? What are the metrics that support the implicit hypothesis that read with same sequence same location are PCR duplicates ? Reflect of miRNA sequencing...","title":"Reflecting on quality control & \u201cfiltering\u201d in RNAseq analysis"},{"location":"read_filtering/#focus-on-quality-control-filtering-in-rnaseq-analysis","text":"","title":"Focus on quality control &amp; \u201cfiltering\u201d in RNAseq analysis"},{"location":"read_filtering/#it-is-tempting-to-filter-the-data-to-get-good-counts","text":"low quality alignments PCR duplicates","title":"It is tempting to filter the data to get \u201cgood counts\u201d"},{"location":"read_filtering/#but","text":"Why low quality reads should be skipped if they were aligned ? Is the implicit hypothesis \"low quality read are miss-mapped\" a likely hypothesis ? When we remove PCR duplicates (exact same sequence and exact same location), are we sure that we remove PCR duplicates ? What are the metrics that support the implicit hypothesis that read with same sequence same location are PCR duplicates ? Reflect of miRNA sequencing...","title":"But.."},{"location":"readcounts/","text":"Reference-base Expression analysis: the key idea Map reads to a reference genome with aligners TopHat TopHat2 HiSat HiSat2 STAR \u2192 These aligners are \u201csplit aware\u201d \u2192 They generate a BAM Alignment file Use a read counting software and annotation information (GTF, GFF3, BED, \u2026) to count the read spanning a gene / transcript The input file for this counting software is the BAM Alignment file Read counts are proxies to RNA steady state levels","title":"The key idea in Reference-base Expression analysis"},{"location":"readcounts/#reference-base-expression-analysis-the-key-idea","text":"","title":"Reference-base Expression analysis: the key idea"},{"location":"readcounts/#map-reads-to-a-reference-genome-with-aligners","text":"TopHat TopHat2 HiSat HiSat2 STAR \u2192 These aligners are \u201csplit aware\u201d \u2192 They generate a BAM Alignment file","title":"Map reads to a reference genome with aligners"},{"location":"readcounts/#use-a-read-counting-software-and-annotation-information-gtf-gff3-bed-to-count-the-read-spanning-a-gene-transcript","text":"The input file for this counting software is the BAM Alignment file","title":"Use a read counting software and annotation information (GTF, GFF3, BED, \u2026) to count the read spanning a gene / transcript"},{"location":"readcounts/#read-counts-are-proxies-to-rna-steady-state-levels","text":"","title":"Read counts are proxies to RNA steady state levels"},{"location":"sequencing_strategies/","text":"Inserts and sequencing strategies in practice, with Illumina paired-end RNAseq protocols you will either deal with: Unstranded RNAseq data IU type from above. Also called fr-unstranded in TopHat/Cufflinks nomenclature Stranded RNAseq data produced with Illumina TrueSeq RNAseq kits ISR type from above or fr-firststrand in TopHat/Cufflinks nomenclature","title":"RNAseq librairies - Inserts and sequencing strategies"},{"location":"sequencing_strategies/#inserts-and-sequencing-strategies","text":"","title":"Inserts and sequencing strategies"},{"location":"sequencing_strategies/#in-practice-with-illumina-paired-end-rnaseq-protocols-you-will-either-deal-with","text":"","title":"in practice, with Illumina paired-end RNAseq protocols you will either deal with:"},{"location":"sequencing_strategies/#unstranded-rnaseq-data","text":"IU type from above. Also called fr-unstranded in TopHat/Cufflinks nomenclature","title":"Unstranded RNAseq data"},{"location":"sequencing_strategies/#stranded-rnaseq-data-produced-with-illumina-trueseq-rnaseq-kits","text":"ISR type from above or fr-firststrand in TopHat/Cufflinks nomenclature","title":"Stranded RNAseq data produced with Illumina TrueSeq RNAseq kits"},{"location":"star/","text":"RNA STAR (option for 50 % of attendees) For information to set proper value for STAR parameters: create a new history and name it RNA STAR Import the 11 datasets from the RNAseq data library to this RNA STAR history, plus the Drosophila_melanogaster.BDGP6.95.gtf file Select the RNA STAR tool with the following parameters to map your reads on the reference genome: Single-end or paired-end reads : Single-end RNA-Seq FASTQ/FASTA file (multiple datasets button), Cmd-shift Select: GSM461176_untreat_single.fastq.gz GSM461179_treat_single.fastq.gz Custom or built-in reference genome: Use a built-in index Reference genome with or without an annotation: use genome reference without builtin gene-model Select reference genome: Drosophila Melanogaster (dm6) Gene model (gff3,gtf) file for splice junctions: the imported Drosophila_melanogaster.BDGP6.95.gtf Length of the genomic sequence around annotated junctions: 44 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Execute Redo the STAR run with 3.2 Select the RNA STAR tool with the following parameters to map your reads on the reference genome: RNA-Seq FASTQ/FASTA file (as multiple datasets), Cmd-shift Select: - GSM461182_untreat_single.fastq.gz 3.7 Length of the genomic sequence around annotated junctions: 74 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Redo a last STAR run for paired-end datasets With the following parameters to map your reads on the reference genome: Single-end or paired-end reads : Paired-end (as multiple datasets) RNA-Seq FASTQ/FASTA file, forward reads (multiple datasets button), Cmd-shift Select: GSM461177_1_untreat_paired.fastq.gz GSM461178_1_untreat_paired.fastq.gz GSM461180_1_treat_paired.fastq.gz `GSM461181_1_treat_paired.fastq.gz RNA-Seq FASTQ/FASTA file, forward reads (multiple datasets button), Cmd-shift Select: GSM461177_2_untreat_paired.fastq.gz GSM461178_2_untreat_paired.fastq.gz GSM461180_2_treat_paired.fastq.gz `GSM461181_2_treat_paired.fastq.gz Custom or built-in reference genome: Use a built-in index Reference genome with or without an annotation: use genome reference without builtin gene-model Select reference genome: Drosophila Melanogaster (dm6) Gene model (gff3,gtf) file for splice junctions: the imported Drosophila_melanogaster.BDGP6.95.gtf Length of the genomic sequence around annotated junctions: 36 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Execute Rename your datasets ! You need now to rename you datasets to facilitate your downstream analysis. Be quiet and focus ! No hurry, this is an important task in the analysis. Search and select datasets with RNA STAR Click on the info icon of both log and bam files Copy the name or one of the two names of the datasets as shown bellow Now click on the pencil icon of the same dataset Paste your text in the Name field of the dataset Edit your text as follow for log files Edit your text as follow for bam files repeat ad lib for all log and bam files","title":"RNA STAR"},{"location":"star/#rna-star-option-for-50-of-attendees","text":"For information to set proper value for STAR parameters: create a new history and name it RNA STAR Import the 11 datasets from the RNAseq data library to this RNA STAR history, plus the Drosophila_melanogaster.BDGP6.95.gtf file Select the RNA STAR tool with the following parameters to map your reads on the reference genome: Single-end or paired-end reads : Single-end RNA-Seq FASTQ/FASTA file (multiple datasets button), Cmd-shift Select: GSM461176_untreat_single.fastq.gz GSM461179_treat_single.fastq.gz Custom or built-in reference genome: Use a built-in index Reference genome with or without an annotation: use genome reference without builtin gene-model Select reference genome: Drosophila Melanogaster (dm6) Gene model (gff3,gtf) file for splice junctions: the imported Drosophila_melanogaster.BDGP6.95.gtf Length of the genomic sequence around annotated junctions: 44 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Execute Redo the STAR run with 3.2 Select the RNA STAR tool with the following parameters to map your reads on the reference genome: RNA-Seq FASTQ/FASTA file (as multiple datasets), Cmd-shift Select: - GSM461182_untreat_single.fastq.gz 3.7 Length of the genomic sequence around annotated junctions: 74 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Redo a last STAR run for paired-end datasets With the following parameters to map your reads on the reference genome: Single-end or paired-end reads : Paired-end (as multiple datasets) RNA-Seq FASTQ/FASTA file, forward reads (multiple datasets button), Cmd-shift Select: GSM461177_1_untreat_paired.fastq.gz GSM461178_1_untreat_paired.fastq.gz GSM461180_1_treat_paired.fastq.gz `GSM461181_1_treat_paired.fastq.gz RNA-Seq FASTQ/FASTA file, forward reads (multiple datasets button), Cmd-shift Select: GSM461177_2_untreat_paired.fastq.gz GSM461178_2_untreat_paired.fastq.gz GSM461180_2_treat_paired.fastq.gz `GSM461181_2_treat_paired.fastq.gz Custom or built-in reference genome: Use a built-in index Reference genome with or without an annotation: use genome reference without builtin gene-model Select reference genome: Drosophila Melanogaster (dm6) Gene model (gff3,gtf) file for splice junctions: the imported Drosophila_melanogaster.BDGP6.95.gtf Length of the genomic sequence around annotated junctions: 36 (This parameter should be length of reads - 1, see above table from fastQC/multiQC analysis) Execute","title":"RNA STAR (option for 50 % of attendees)"},{"location":"star/#rename-your-datasets","text":"You need now to rename you datasets to facilitate your downstream analysis. Be quiet and focus ! No hurry, this is an important task in the analysis. Search and select datasets with RNA STAR Click on the info icon of both log and bam files Copy the name or one of the two names of the datasets as shown bellow Now click on the pencil icon of the same dataset Paste your text in the Name field of the dataset Edit your text as follow for log files Edit your text as follow for bam files repeat ad lib for all log and bam files","title":"Rename your datasets !"},{"location":"transcript_quant/","text":"Transcript Quantification Note that we use absolute read counts because we are going to compare counts across samples. Other metrics for comparison of genes within the same sample are: CPM (Counts Per Million) Each gene count is divided by the corresponding library size (in millions). RPKM (reads per kilobase of exons per million mapped reads) TPM (Transcript per Million) Divide the read counts by the length of each gene in kilobases. This gives you reads per kilobase (RPK). Sum up all the RPK values in a sample and divide this number by 1,000,000. This is your \u201cper million\u201d scaling factor. Divide the RPK values by the \u201cper million\u201d scaling factor. This gives you TPM","title":"Transcript Quantification"},{"location":"transcript_quant/#transcript-quantification","text":"Note that we use absolute read counts because we are going to compare counts across samples. Other metrics for comparison of genes within the same sample are: CPM (Counts Per Million) Each gene count is divided by the corresponding library size (in millions). RPKM (reads per kilobase of exons per million mapped reads) TPM (Transcript per Million) Divide the read counts by the length of each gene in kilobases. This gives you reads per kilobase (RPK). Sum up all the RPK values in a sample and divide this number by 1,000,000. This is your \u201cper million\u201d scaling factor. Divide the RPK values by the \u201cper million\u201d scaling factor. This gives you TPM","title":"Transcript Quantification"},{"location":"uploads/","text":"Data The original data is available at NCBI Gene Expression Omnibus (GEO) under accession number GSE18508 . It is also mirrored at the EBI Small Read Archive under the accession number SRP001537 The data was generated through deep Sequencing of mRNA from the Drosophila melanogaster S2-DRSC cells that have been RNAi depleted of mRNAs encoding RNA binding proteins. In the tutorial, we are going to focus on 7 datasets generated to study the effect of the Pasilla gene inactivation by RNAi knock-down. 4 untreated samples: GSM461176, GSM461177, GSM461178, GSM461182 3 treated samples (Pasilla gene depleted by RNAi): GSM461179, GSM461180, GSM461181 Each sample constitutes a separate biological replicate of the corresponding condition (treated or untreated). Two of the treated and two of the untreated samples are from a paired-end sequencing assay, while the remaining samples are from a single-end sequencing experiment. Thus the following table will be (very) useful in our analysis since each of the 7 datasets are designated with (i) its original ID in GEO (or EBI SRA) (ii) its condition (untreated or treated) and (iii) the sequencing technology used (single read or paired-end). GSM461176_untreat_single - SRR031709_untreat_single GSM461177_untreat_paired - SRR031714_untreat_paired GSM461178_untreat_paired - SRR031716_untreat_paired GSM461179_treat_single - SRR031718_treat_single GSM461180_treat_paired - SRR031724_treat_paired GSM461181_treat_paired - SRR031726_treat_paired GSM461182_untreat_single - SRR031728_untreat_single Data upload We will take benefit of this mandatory stage, to review various possibilities to upload dataset in Galaxy. Then you will have the possibility to import the full set of the 7 FASTQ files in one of your histories, from a data library that has been pre-set in your Galaxy server for this training session. Uploading data from your local computer Download the sample GSM461176/SRR031709 to your computer. Upload this local file SRR031709.fastq.gz to your Galaxy history using the upload/Download Galaxy interface that pops up if you click the upload icone Importing data via links ! The sample GSM461177/SRR031714 was sequenced using paired-end sequencing. Thus, there are 2 files for forward and reverse reading of DNA fragment ends, respectively. GSM461177_1/SRR031714_1 (forward reads) can be downloaded from the link ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_1.fastq.gz GSM461177_2/SRR031714_2 (reverse reads) can be downloaded from the link ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_2.fastq.gz However, do not download these files on your local machine. Instead, copy the links ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_1.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_2.fastq.gz and paste them in the Paste/Fetch data tab of the Galaxy upload interface. In addition, select fastqsanger.gz in the Type menu. Press the start button. Importing data via the EBI SRA ENA SRA The sample GSM461178/SRR031716 is also a paired-end sequencing. This time, we are going to download the two corresponding fastq.gz files directly from the EBI SRA using the tool EBI SRA ENA SRA in the Get data tool submenu. Click on the tool EBI SRA ENA SRA (you can select it rapidly using the search bar) In the search box of the EBI SRA website, enter SRR031716 Two categories of results are retrieved, Experiment and Run. What we want to get are the files from the sequencing runs. Thus, click the SRR031716 link in the Run section (1 results found). Click on \"File 1\" in the FASTQ files (Galaxy) Column. You will be switched back to the Galaxy interface, and the download of the SRR031716_1.fastq.gz file will start immediately as a yellow dataset in the history right panel. Without waiting for the complete download of SRR031716_1.fastq.gz, you can repeat the previous steps 1, 2, 3 and 4. Just Click on File 2 instead of File 1 in step 4 Importing data from data libraries For collaborative work, Galaxy offers data libraries, where datasets can be stored and available to one or multiple users. This is what we are going to use to import rapidly all the input data you need for this RNAseq analysis. All datasets have been preloaded in the data library named RNAseq . To access this library and import its content in your histories: Click the menu Donn\u00e9es partag\u00e9es ( Shared data ) and select the submenu Biblioth\u00e8que de Donn\u00e9es ( Data libraries ). Navigate to the data library RNAseq Select all datasets Click the To History button and select as Datasets In the pop up window, or create new and type Input data to transfer the datasets in a new history with this name. Click on the green box to navigate to this new history (or click on the main menu analyse data ) and start using these datasets.","title":"Data upload"},{"location":"uploads/#data","text":"The original data is available at NCBI Gene Expression Omnibus (GEO) under accession number GSE18508 . It is also mirrored at the EBI Small Read Archive under the accession number SRP001537 The data was generated through deep Sequencing of mRNA from the Drosophila melanogaster S2-DRSC cells that have been RNAi depleted of mRNAs encoding RNA binding proteins. In the tutorial, we are going to focus on 7 datasets generated to study the effect of the Pasilla gene inactivation by RNAi knock-down. 4 untreated samples: GSM461176, GSM461177, GSM461178, GSM461182 3 treated samples (Pasilla gene depleted by RNAi): GSM461179, GSM461180, GSM461181 Each sample constitutes a separate biological replicate of the corresponding condition (treated or untreated). Two of the treated and two of the untreated samples are from a paired-end sequencing assay, while the remaining samples are from a single-end sequencing experiment. Thus the following table will be (very) useful in our analysis since each of the 7 datasets are designated with (i) its original ID in GEO (or EBI SRA) (ii) its condition (untreated or treated) and (iii) the sequencing technology used (single read or paired-end). GSM461176_untreat_single - SRR031709_untreat_single GSM461177_untreat_paired - SRR031714_untreat_paired GSM461178_untreat_paired - SRR031716_untreat_paired GSM461179_treat_single - SRR031718_treat_single GSM461180_treat_paired - SRR031724_treat_paired GSM461181_treat_paired - SRR031726_treat_paired GSM461182_untreat_single - SRR031728_untreat_single","title":"Data"},{"location":"uploads/#data-upload","text":"We will take benefit of this mandatory stage, to review various possibilities to upload dataset in Galaxy. Then you will have the possibility to import the full set of the 7 FASTQ files in one of your histories, from a data library that has been pre-set in your Galaxy server for this training session.","title":"Data upload"},{"location":"uploads/#uploading-data-from-your-local-computer","text":"Download the sample GSM461176/SRR031709 to your computer. Upload this local file SRR031709.fastq.gz to your Galaxy history using the upload/Download Galaxy interface that pops up if you click the upload icone","title":"Uploading data from your local computer"},{"location":"uploads/#importing-data-via-links","text":"The sample GSM461177/SRR031714 was sequenced using paired-end sequencing. Thus, there are 2 files for forward and reverse reading of DNA fragment ends, respectively. GSM461177_1/SRR031714_1 (forward reads) can be downloaded from the link ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_1.fastq.gz GSM461177_2/SRR031714_2 (reverse reads) can be downloaded from the link ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_2.fastq.gz However, do not download these files on your local machine. Instead, copy the links ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_1.fastq.gz ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR031/SRR031714/SRR031714_2.fastq.gz and paste them in the Paste/Fetch data tab of the Galaxy upload interface. In addition, select fastqsanger.gz in the Type menu. Press the start button.","title":"Importing data via links !"},{"location":"uploads/#importing-data-via-the-ebi-sra-ena-sra","text":"The sample GSM461178/SRR031716 is also a paired-end sequencing. This time, we are going to download the two corresponding fastq.gz files directly from the EBI SRA using the tool EBI SRA ENA SRA in the Get data tool submenu.","title":"Importing data via the EBI SRA ENA SRA"},{"location":"uploads/#importing-data-from-data-libraries","text":"For collaborative work, Galaxy offers data libraries, where datasets can be stored and available to one or multiple users. This is what we are going to use to import rapidly all the input data you need for this RNAseq analysis. All datasets have been preloaded in the data library named RNAseq . To access this library and import its content in your histories: Click the menu Donn\u00e9es partag\u00e9es ( Shared data ) and select the submenu Biblioth\u00e8que de Donn\u00e9es ( Data libraries ). Navigate to the data library RNAseq Select all datasets Click the To History button and select as Datasets In the pop up window, or create new and type Input data to transfer the datasets in a new history with this name. Click on the green box to navigate to this new history (or click on the main menu analyse data ) and start using these datasets.","title":"Importing data from data libraries"},{"location":"visu_map/","text":"","title":"Visu map"},{"location":"visualisation/","text":"","title":"Inspection of the mapping results"}]}