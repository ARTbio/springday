<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>GO - Galaxy Spring day 2019</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "GO";
    var mkdocs_page_input_path = "GO-tool.md";
    var mkdocs_page_url = "/springday/GO-tool/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Galaxy Spring day 2019</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Pretreatments</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../uploads/">Data upload</a>
                </li>
                <li class="">
                    
    <a class="" href="../QC/">Quality control</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Outline and general concepts for the RNAseq analysis</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../cDNAs/">RNAseq librairies - cDNA synthesis</a>
                </li>
                <li class="">
                    
    <a class="" href="../sequencing_strategies/">RNAseq librairies - Inserts and sequencing strategies</a>
                </li>
                <li class="">
                    
    <a class="" href="../readcounts/">The key idea in Reference-base Expression analysis</a>
                </li>
                <li class="">
                    
    <a class="" href="../read_filtering/">Reflecting on quality control & “filtering” in RNAseq analysis</a>
                </li>
                <li class="">
                    
    <a class="" href="../transcript_quant/">Transcript Quantification</a>
                </li>
                <li class="">
                    
    <a class="" href="../RNAseq_DE/">Statistical Analysis of Differential expression</a>
                </li>
                <li class="">
                    
    <a class="" href="../outline_conclusion/">Experimental procedures affect downstream analyses</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Quality filtering</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Cutadapt/">Optional filtering of reads on sequence quality</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mapping</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../mapping/">Mapping</a>
                </li>
                <li class="">
                    
    <a class="" href="../star/">RNA STAR</a>
                </li>
                <li class="">
                    
    <a class="" href="../hisat2/">HiSAT2</a>
                </li>
                <li class="">
                    
    <a class="" href="../bam/">BAM inspection</a>
                </li>
                <li class="">
                    
    <a class="" href="../visu_map/">Visualisation of read mapping</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Analysis of the differential gene expression</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../intro_counting/">Introduction to read counting</a>
                </li>
                <li class="">
                    
    <a class="" href="../strandness/">Estimation of the strandness</a>
                </li>
                <li class="">
                    
    <a class="" href="../count/">Count the number of reads per annotated gene</a>
                </li>
                <li class="">
                    
    <a class="" href="../DE_intro/">Identification of the differentially expressed features - DESeq2</a>
                </li>
                <li class="">
                    
    <a class="" href="../DEDESeq2/">DESeq2 use</a>
                </li>
                <li class="">
                    
    <a class="" href="../volcano/">Volcano Plot</a>
                </li>
                <li class="">
                    
    <a class="" href="../DEseq2visu/">Visualization of the differentially expressed genes</a>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Analysis of functional enrichment among the differentially expressed genes</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../GO-intro/">Introduction</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">GO</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#prepare-the-datasets-for-goseq">Prepare the datasets for GOSeq</a></li>
    

    <li class="toctree-l4"><a href="#perform-go-analysis">Perform GO analysis</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#how-many-go-terms-are-over-represented-at-adjusted-p-value-005">How many GO terms are over-represented at adjusted P value &lt; 0.05?</a></li>
        
            <li><a class="toctree-l5" href="#under-represented">Under-represented?</a></li>
        
            <li><a class="toctree-l5" href="#how-are-the-over-represented-go-terms-divided-between-mf-cc-and-bp">How are the over-represented GO terms divided between MF, CC and BP?</a></li>
        
            <li><a class="toctree-l5" href="#and-for-under-represented-go-terms">And for under-represented GO terms?</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Galaxy Workflows</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../workflow_intro/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../workflow_use/">Example</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Galaxy Spring day 2019</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Analysis of functional enrichment among the differentially expressed genes &raquo;</li>
        
      
        
          <li>Analysis of the differential gene expression &raquo;</li>
        
      
    
    <li>GO</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ARTbio/springday/edit/master/docs/GO-tool.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><img alt="" src="../images/galaxylogo.png" /></p>
<h2 id="prepare-the-datasets-for-goseq">Prepare the datasets for GOSeq</h2>
<hr />
<p><img alt="" src="../images/tool_small.png" /></p>
<ol>
<li>Select <code>Compute an expression on every row</code> tool with<ul>
<li><code>Add expression</code>: bool(c7&lt;0.05)</li>
<li><code>as a new column to</code>: the DESeq2 result file</li>
</ul>
</li>
</ol>
<hr />
<p><img alt="" src="../images/tool_small.png" /></p>
<ol>
<li><code>Cut</code> tool with<ul>
<li><code>Cut columns</code>: c1,c8</li>
<li><code>Delimited by</code>: Tab</li>
<li><code>From</code>: the output of the Compute tool</li>
</ul>
</li>
</ol>
<hr />
<p><img alt="" src="../images/tool_small.png" /></p>
<ol>
<li><code>Change Case</code> tool with<ul>
<li><code>From</code>: the output of the previous Cut tool</li>
<li><code>Change case of columns</code>: c1</li>
<li><code>Delimited by</code>: Tab</li>
<li><code>To</code>: Upper case</li>
</ul>
</li>
</ol>
<p>This generates the first input for goseq. We need as second input for goseq, the gene lengths.
We can use there the gene length generated by featureCounts tool and reformat it a bit.</p>
<hr />
<p><img alt="" src="../images/tool_small.png" /></p>
<ol>
<li>Copy one output of type <code>...: Feature lengths</code> of the 7 featureCounts runs in the history <code>STAR</code>/<code>HISAT2</code></li>
<li>Rename it <code>Lengths</code></li>
<li><code>Change Case</code> tool with<ul>
<li><code>From</code>: the feature lengths (output of featureCounts tool)</li>
<li><code>Change case of columns</code>: c1</li>
<li><code>Delimited by</code>: Tab</li>
<li><code>To</code>: Upper case</li>
</ul>
</li>
</ol>
<p>We have now the two required input files for goseq.</p>
<h2 id="perform-go-analysis">Perform GO analysis</h2>
<hr />
<p><img alt="" src="../images/tool_small.png" /></p>
<ol>
<li>Select <code>goseq</code> tool with<ul>
<li><code>Differentially expressed genes file</code> : first file generated by Change Case tool on previous step</li>
<li><code>Gene lengths file</code> : second file generated by Change Case tool on previous step</li>
<li><code>Gene categories</code> : Get categories</li>
<li><code>Select a genome to use</code> : Fruit fly (dm6)</li>
<li><code>Select Gene ID format</code> : Ensembl Gene ID</li>
<li><code>Select one or more categories</code> : GO: Cellular Component, GO: Biological Process, GO: Molecular Function</li>
</ul>
</li>
</ol>
<p>goseq generates a big table with the following columns for each GO term:</p>
<table>
<thead>
<tr>
<th>category</th>
<th>GO category</th>
</tr>
</thead>
<tbody>
<tr>
<td>over_rep_pval</td>
<td>p-value for over representation of the term in the differentially expressed genes</td>
</tr>
<tr>
<td>under_rep_pval</td>
<td>p-value for under representation of the term in the differentially expressed genes</td>
</tr>
<tr>
<td>numDEInCat</td>
<td>number of differentially expressed genes in this category</td>
</tr>
<tr>
<td>numInCat</td>
<td>number of genes in this category</td>
</tr>
<tr>
<td>term</td>
<td>detail of the term</td>
</tr>
<tr>
<td>ontology</td>
<td>MF (Molecular Function - molecular activities of gene products), CC (Cellular Component - where gene products are active), BP (Biological Process - pathways and larger processes made up of the activities of multiple gene products)</td>
</tr>
<tr>
<td>p.adjust.over_represented</td>
<td>p-value for over representation of the term in the differentially expressed genes, adjusted for multiple testing with the Benjamini-Hochberg procedure</td>
</tr>
<tr>
<td>p.adjust.under_represented</td>
<td>p-value for over representation of the term in the differentially expressed genes, adjusted for multiple testing with the Benjamini-Hochberg procedure</td>
</tr>
</tbody>
</table>
<p>To identify categories significantly enriched/unenriched below some p-value cutoff, it is necessary to use the adjusted p-value.</p>
<h4 id="how-many-go-terms-are-over-represented-at-adjusted-p-value-005">How many GO terms are over-represented at adjusted P value &lt; 0.05?</h4>
<h4 id="under-represented">Under-represented?</h4>
<h4 id="how-are-the-over-represented-go-terms-divided-between-mf-cc-and-bp">How are the over-represented GO terms divided between MF, CC and BP?</h4>
<h4 id="and-for-under-represented-go-terms">And for under-represented GO terms?</h4>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../workflow_intro/" class="btn btn-neutral float-right" title="Introduction">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../GO-intro/" class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ARTbio/springday/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../GO-intro/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../workflow_intro/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
